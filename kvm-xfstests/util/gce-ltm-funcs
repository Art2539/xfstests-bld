
function send_to_ltm() {
    . $DIR/.ltm_instance
    local cmd_to_send=$1

    # Validate certificate
    curl --cacert $GCE_LTM_SERVER_CERT -H "Content-Type: application/json" \
	-d "{\"orig_cmdline\": \"$cmd_to_send\"}" \
	--resolve "a.$GCE_PROJECT.gce-xfstests:443:$GCE_LTM_EXT_IP" \
	-X POST "https://a.$GCE_PROJECT.gce-xfstests/gce-xfstests"

    if [ $? != 0 ]; then
	echo "Request failed."
	if gcloud compute instances describe "xfstests-ltm" &> /dev/null; then
	    echo "The ltm instance seems to be running. Try deleting the"
	    echo "$DIR/.ltm_instance file and re-running launch-ltm to recreate"
	    echo "the file. If the issue persists, try relaunching the LTM"
	else
	   echo "The ltm doesn't seem to be running. Try launching the ltm"
	   echo "instance with launch-ltm. This will recreate the"
	   echo ".ltm_instance file."
	fi
	return 1
    fi

}

